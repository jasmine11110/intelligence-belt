# 赟原科技蓝牙设备小程序

一个基于微信小程序的蓝牙设备连接和控制平台，支持自动搜索设备、手动连接、设备控制等功能。

## 功能特性

### 🔐 登录系统
- 简洁的登录界面
- 自动检查蓝牙权限
- 权限验证和错误提示

### 📱 蓝牙设备管理
- **自动搜索设备**：登录后自动开始搜索附近的蓝牙设备
- **手动选择连接**：用户可以从设备列表中选择要连接的设备
- **实时状态显示**：显示连接状态、设备信息、信号强度等
- **智能设备过滤**：自动过滤无效设备，只显示有名称的设备

### 🎛️ 设备控制
- **压力值监控**：实时显示设备压力值
- **工作模式切换**：支持舒适、性能、强劲三种模式
- **加热功能控制**：一键切换加热功能
- **原始数据显示**：显示接收到的原始数据用于调试

### 🎨 用户界面
- **现代化设计**：采用卡片式布局，界面简洁美观
- **响应式布局**：适配不同屏幕尺寸
- **状态指示**：清晰的状态图标和文字提示
- **操作反馈**：Toast提示和加载状态

## 技术架构

### 核心模块
- **蓝牙适配器管理**：初始化、状态检查、权限管理
- **设备扫描**：自动搜索、设备过滤、列表管理
- **连接管理**：设备连接、服务发现、特征值操作
- **数据通信**：数据发送、接收、解析
- **状态管理**：连接状态、设备状态、UI状态

### 技术栈
- 微信小程序原生开发
- 蓝牙低功耗(BLE)通信
- Promise异步编程
- 模块化代码组织

## 使用说明

### 1. 环境准备
- 微信开发者工具
- 支持蓝牙的设备（手机/平板）
- 蓝牙设备（如智能腰带等）

### 2. 权限配置
确保在 `app.json` 中配置了必要的权限：
```json
{
  "permission": {
    "scope.userLocation": {
      "desc": "用于蓝牙设备扫描和连接时获取您的地理位置"
    },
    "scope.bluetooth": {
      "desc": "用于连接和控制蓝牙设备"
    }
  }
}
```

### 3. 使用流程
1. **登录**：点击"立即登录"按钮，系统会自动检查蓝牙权限
2. **搜索设备**：登录成功后自动开始搜索附近的蓝牙设备
3. **选择设备**：从设备列表中选择要连接的设备
4. **连接设备**：点击设备名称进行连接
5. **控制设备**：连接成功后可以使用各种控制功能

### 4. 设备控制
- **模式切换**：点击舒适/性能/强劲按钮切换工作模式
- **加热控制**：点击"切换加热"按钮控制加热功能
- **断开连接**：点击"断开连接"按钮断开设备连接

## 开发说明

### 项目结构
```
wx-simple-bluetooth-master/
├── pages/
│   ├── login/          # 登录页面
│   └── bluetooth/      # 蓝牙设备页面
├── modules/            # 蓝牙相关模块
├── view/               # 公共组件
└── app.json           # 应用配置
```

### 核心文件
- `pages/login/login.js` - 登录逻辑和权限检查
- `pages/bluetooth/bluetooth.js` - 蓝牙设备管理核心逻辑
- `view/toast.js` - Toast提示组件

### 蓝牙API使用
项目使用了微信小程序的蓝牙API：
- `wx.openBluetoothAdapter()` - 初始化蓝牙适配器
- `wx.startBluetoothDevicesDiscovery()` - 开始搜索设备
- `wx.createBLEConnection()` - 连接设备
- `wx.getBLEDeviceServices()` - 获取设备服务
- `wx.getBLEDeviceCharacteristics()` - 获取特征值
- `wx.notifyBLECharacteristicValueChange()` - 订阅数据变化
- `wx.writeBLECharacteristicValue()` - 写入数据

## 注意事项

### 权限要求
- **蓝牙权限**：需要用户授权蓝牙访问权限
- **位置权限**：Android设备需要位置权限才能搜索蓝牙设备
- **后台运行**：配置了蓝牙后台运行模式

### 兼容性
- **iOS**：支持iOS 9.0及以上版本
- **Android**：支持Android 4.3及以上版本
- **微信版本**：需要微信6.5.6及以上版本

### 常见问题
1. **搜索不到设备**：检查设备是否开启、距离是否过远、权限是否授权
2. **连接失败**：检查设备是否支持BLE、是否处于可连接状态
3. **数据异常**：检查设备协议是否正确、特征值是否匹配

## 更新日志

### v1.0.0 (2024-01-01)
- 初始版本发布
- 实现基本的蓝牙设备搜索和连接功能
- 支持设备控制和数据监控
- 现代化UI设计

## 许可证

MIT License

## 联系方式

如有问题或建议，请联系开发团队。
